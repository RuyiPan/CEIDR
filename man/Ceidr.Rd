% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/CEIDR.R
\name{Ceidr}
\alias{Ceidr}
\title{Cluster Enhancement for testing Individual Differences in intermodal coupling (r)}
\usage{
Ceidr(
  m1,
  m2,
  cov.df,
  distmat,
  cortex = NULL,
  cov.nuisance = NULL,
  cov.interest = NULL,
  between.mod = list(mu.formula1 = ~1, sigma.formula1 = ~1, family1 = NO(), mu.formula2 =
    ~1, sigma.formula2 = ~1, family2 = NO()),
  within.radius = 5,
  max.radius = 15,
  perm = "Manly",
  nperm = 2000,
  alpha = 0.05,
  parallel = F,
  ncores = 1,
  seed = 1
)
}
\arguments{
\item{m1}{A matrix of modality 1 values (subjects × vertices).}

\item{m2}{A matrix of modality 2 values (same dimensions as `m1`).}

\item{cov.df}{A data frame of subject-level covariates (rows aligned with subjects in `m1`/`m2`).}

\item{distmat}{A vertex × vertex spatial distance matrix.}

\item{cortex}{Optional vector of vertex indices to include. If `NULL`, all vertices are used.}

\item{cov.nuisance}{Character vector of column names in `cov_df` to adjust for as nuisance covariates.}

\item{cov.interest}{Character vector of column names in `cov_df` that are the covariates of interest.}

\item{between.mod}{For between-subject adjustment: a list specifying modeling formulas and GAMLSS families:
\describe{
  \item{mu.formula1, mu.formula2}{Formulas for the mean of modality 1 and 2}
  \item{sigma.formula1, sigma.formula2}{Formulas for the variance of modality 1 and 2}
  \item{family1, family2}{GAMLSS families for each modality (e.g., \code{NO()})}
}}

\item{within.radius}{Radius (in distance units) used to define the local neighborhood for within-subject adjustment.}

\item{max.radius}{Maximum radius for spatial cluster enhancement in the permutation step.}

\item{perm}{Type of permutation. Currently supports \code{"Manly"} or \code{"Draper–Stoneman"}.}

\item{nperm}{Number of permutations to run for inference.}

\item{alpha}{Significance level used in inference (default is 0.05).}

\item{parallel}{Logical, whether to use parallel processing for spatial permutation inference.}

\item{ncores}{Number of CPU cores to use when \code{parallel = TRUE}.}

\item{seed}{Random seed for reproducibility.}
}
\value{
A list with the following components:
\describe{
  \item{Tstat}{A length-\code{V} vector of cluster-enhanced test statistics obtained by CLEAN. Non-cortex vertices take the value 0.}
  \item{Tstat_thresholded}{Cluster-enhanced test statistics thresholded at a pre-set FWER level (\code{alpha}). Vertices not passing the threshold are shrunk to 0. Non-cortex vertices are 0.}
  \item{permMax}{A length-\code{nperm} vector of the maximum cluster-enhanced test statistic across all vertices for each permutation. Used to compute FWER-controlling threshold.}
  \item{permMin}{A length-\code{nperm} vector of the minimum cluster-enhanced test statistic across all vertices for each permutation.}
  \item{threshold}{FWER-controlling threshold.}
  \item{nperm}{Number of permutations used.}
  \item{seed}{Random seed used.}
  \item{nlocations}{Number of cortical vertices used in the analysis.}
  \item{alternative}{Type of alternative hypothesis: \code{"two.sided"}, \code{"greater"}, or \code{"less"}.}
  \item{couplings}{Estimated subject-level intermodal couplings.}
}
}
\description{
Run CEIDR to test individual differences in spatially-structured intermodal coupling.
}
\examples{
Example (with simulated data)
Ceidr(m1, m2, cov_df, distmat, cov.interest = c("x"),  cov.nuisance = c("z"))

}
\references{
TODO
}
